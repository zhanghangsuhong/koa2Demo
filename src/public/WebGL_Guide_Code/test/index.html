<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>

<body>

	<canvas id="webgl" width="400" height="400"></canvas>

	<script src="../lib/webgl-utils.js"></script>
	<script src="../lib/webgl-debug.js"></script>
	<script src="../lib/cuon-utils.js"></script>
	<script src="../lib/cuon-matrix.js"></script>
	<script>

		class WebglTest {
			constructor() {
			}

			//三角形
			drawTriangle() {
				var VSHADER_SOURCE =
					'attribute vec4 a_Position;' +
					'void main(){' +
					'gl_Position = a_Position;' +
					'}'

				var FSHADER_SOURCE =
					'void main(){' +
					'gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);' +
					'}'
				var canvas = document.getElementById('webgl'),
					gl = canvas.getContext('webgl')
				gl.viewport(0, 0, canvas.clientWidth, canvas.clientHeight)
				initShaders(gl, VSHADER_SOURCE, FSHADER_SOURCE)

				var vertices = new Float32Array([
					0.0, 0.5, -0.5, -0.5, 0.5, -0.5
				])

				var n = 3

				var vertexBuffer = gl.createBuffer()

				gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer)
				gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW)

				var a_Position = gl.getAttribLocation(gl.program, 'a_Position')
				gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0);
				gl.enableVertexAttribArray(a_Position);

				gl.clearColor(0.0, 0, 0, 1)
				gl.clear(gl.COLOR_BUFFER_BIT)
				//第二个参数表示从那里绘制
				gl.drawArrays(gl.TRIANGLES, 0, n)
			}

			//三个点
			drawManyPoint() {
				var VSHADER_SOURCE =
					'attribute vec4 a_Position;' +
					'void main(){' +
					'gl_Position = a_Position;' +
					'gl_PointSize = 10.0;' +
					'}'

				var FSHADER_SOURCE =
					'void main(){' +
					'gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);' +
					'}'
				var canvas = document.getElementById('webgl'),
					gl = canvas.getContext('webgl')
				gl.viewport(0, 0, canvas.clientWidth, canvas.clientHeight)
				initShaders(gl, VSHADER_SOURCE, FSHADER_SOURCE)

				var vertices = new Float32Array([
					0.0, 0.5, -0.5, -0.5, 0.5, -0.5
				])

				var n = 3

				var vertexBuffer = gl.createBuffer()

				gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer)
				gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW)

				var a_Position = gl.getAttribLocation(gl.program, 'a_Position')
				gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0);
				gl.enableVertexAttribArray(a_Position);

				gl.clearColor(0.0, 0, 0, 1)
				gl.clear(gl.COLOR_BUFFER_BIT)
				//第二个参数表示从那里绘制
				gl.drawArrays(gl.POINTS, 0, n)
			}

			//点
			drawPoint() {
				var VSHADER_SOURCE =
					'attribute vec4 a_Position;' +
					'void main(){' +
					'gl_Position = a_Position;' +
					'gl_PointSize = 10.0;' +
					'}'

				var FSHADER_SOURCE =
					'void main(){' +
					'gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);' +
					'}'
				var canvas = document.getElementById('webgl'),
					gl = canvas.getContext('webgl')
				gl.viewport(0, 0, canvas.clientWidth, canvas.clientHeight)
				initShaders(gl, VSHADER_SOURCE, FSHADER_SOURCE)
				var a_Position = gl.getAttribLocation(gl.program, 'a_Position')
				gl.vertexAttrib3f(a_Position, 0.0, 0.0, 0.0)
				gl.clearColor(0.0, 0, 0, 1)
				gl.clear(gl.COLOR_BUFFER_BIT)
				gl.drawArrays(gl.POINTS, 0, 1)
			}

			//有视点的三维三角形
			lookAtTriangles() {
				var VSHADER_SOURCE =
					'attribute vec4 a_Position;\n' +
					'attribute vec4 a_Color;\n' +
					'uniform mat4 u_ViewMatrix;\n' +
					'varying vec4 v_Color;\n' +
					'void main() {\n' +
					'  gl_Position = u_ViewMatrix * a_Position;\n' +
					'  v_Color = a_Color;\n' +
					'}\n';

				var FSHADER_SOURCE =
					'#ifdef GL_ES\n' +
					'precision mediump float;\n' +
					'#endif\n' +
					'varying vec4 v_Color;\n' +
					'void main() {\n' +
					'  gl_FragColor = v_Color;\n' +
					'}\n';

				var canvas = document.getElementById('webgl')

				var gl = getWebGLContext(canvas);
				initShaders(gl, VSHADER_SOURCE, FSHADER_SOURCE)

				var verticesColors = new Float32Array([

					0.0, 0.5, -0.4, 0.4, 1.0, 0.4,
					-0.5, -0.5, -0.4, 0.4, 1.0, 0.4,
					0.5, -0.5, -0.4, 1.0, 0.4, 0.4,

					0.5, 0.4, -0.2, 1.0, 0.4, 0.4,
					-0.5, 0.4, -0.2, 1.0, 1.0, 0.4,
					0.0, -0.6, -0.2, 1.0, 1.0, 0.4,

					0.0, 0.5, 0.0, 0.4, 0.4, 1.0,
					-0.5, -0.5, 0.0, 0.4, 0.4, 1.0,
					0.5, -0.5, 0.0, 1.0, 0.4, 0.4,
				])

				var n = 9

				var vertexColorbuffer = gl.createBuffer()

				gl.bindBuffer(gl.ARRAY_BUFFER, vertexColorbuffer)
				gl.bufferData(gl.ARRAY_BUFFER, verticesColors, gl.STATIC_DRAW)

				var FSIZE = verticesColors.BYTES_PER_ELEMENT
				var a_Position = gl.getAttribLocation(gl.program, 'a_Position')
				gl.vertexAttribPointer(a_Position, 3, gl.FLOAT, false, FSIZE * 6, 0)
				gl.enableVertexAttribArray(a_Position)

				var a_Color = gl.getAttribLocation(gl.program, 'a_Color')
				gl.vertexAttribPointer(a_Color, 3, gl.FLOAT, false, FSIZE * 6, FSIZE * 3)
				gl.enableVertexAttribArray(a_Color)


				gl.clearColor(0, 0, 0, 1)

				var u_ViewMatrix = gl.getUniformLocation(gl.program, 'u_ViewMatrix')

				var viewMatrix = new Matrix4()
				viewMatrix.setLookAt(0.20, 0.25, 0.25, 0, 0, 0, 0, 1, 0)

				gl.uniformMatrix4fv(u_ViewMatrix, false, viewMatrix.elements)

				gl.clear(gl.COLOR_BUFFER_BIT)

				gl.drawArrays(gl.TRIANGLES, 0, n)

			}

			//旋转带有视点的三维三角形
			LookAtRotatedTriangles() {

			}

		}


		!function () {
			const webglTest = new WebglTest()
			webglTest.lookAtTriangles()
		}()







	</script>
</body>

</html>